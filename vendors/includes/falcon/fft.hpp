#pragma once
#include <cmath>
#include <complex>
#include <numbers>

// (inverse) Fast Fourier Transform of degree-{511, 1023} polynomial f ∈
// Q[x]/(φ) s.t. φ is a monic with distinct roots over C
namespace fft {

using cmplx = std::complex<double>;

// Given a 64 -bit unsigned integer, this routine extracts specified many
// contiguous bits from ( least significant bit ) LSB side & reverses their bit
// order, returning bit reversed `mbw` -bit wide number
//
// See
// https://github.com/itzmeanjan/falcon/blob/19a8593/include/ntt.hpp#L37-L57
// for source of inspiration
template<const size_t mbw>
inline static constexpr size_t
bit_rev(const size_t v)
  requires((mbw > 0) && (mbw <= 10))
{
  size_t v_rev = 0ul;

  for (size_t i = 0; i < mbw; i++) {
    const size_t bit = (v >> i) & 0b1;
    v_rev ^= bit << (mbw - 1ul - i);
  }

  return v_rev;
}

// Given k ∈ [0, n), this routine computes e ^ (i * ((π * k) / n)) using Euler's
// formula https://en.wikipedia.org/wiki/Euler%27s_formula
//
// e ^ iθ = cosθ + isinθ | i = √-1
template<const size_t n>
inline cmplx
computeζ(const size_t k)
{
  constexpr double π = std::numbers::pi;
  const double θ = π * static_cast<double>(k) / static_cast<double>(n);
  return { std::cos(θ), std::sin(θ) };
}

// Pre-computed table of powers of ζ required when performing FFT over
// polynomials of degree power of 2 ∈ [2, 1024] s.t. it's computed as follows
//
// for i in (0..1024]:
//    POWERS_OF_ζ[i] = computeζ<1024>(bit_rev<10>(i))
//
// I would love to perform this computation at compile-time and put resulting
// table as std::array, but std::cos and std::sin are not *yet* constexpr.
constexpr fft::cmplx POWERS_OF_ζ[1024]{
  { 1.0, 0.0 },
  { 6.123233995736766e-17, 1.0 },
  { 0.7071067811865476, 0.7071067811865475 },
  { -0.7071067811865475, 0.7071067811865476 },
  { 0.9238795325112867, 0.3826834323650898 },
  { -0.3826834323650897, 0.9238795325112867 },
  { 0.38268343236508984, 0.9238795325112867 },
  { -0.9238795325112867, 0.38268343236508984 },
  { 0.9807852804032304, 0.19509032201612825 },
  { -0.1950903220161282, 0.9807852804032304 },
  { 0.5555702330196023, 0.8314696123025451 },
  { -0.8314696123025453, 0.5555702330196022 },
  { 0.8314696123025452, 0.5555702330196022 },
  { -0.555570233019602, 0.8314696123025455 },
  { 0.1950903220161283, 0.9807852804032304 },
  { -0.9807852804032304, 0.19509032201612858 },
  { 0.9951847266721969, 0.0980171403295606 },
  { -0.09801714032956066, 0.9951847266721969 },
  { 0.6343932841636456, 0.7730104533627369 },
  { -0.773010453362737, 0.6343932841636455 },
  { 0.881921264348355, 0.47139673682599764 },
  { -0.4713967368259977, 0.881921264348355 },
  { 0.2902846772544623, 0.9569403357322089 },
  { -0.9569403357322088, 0.29028467725446233 },
  { 0.9569403357322088, 0.29028467725446233 },
  { -0.2902846772544622, 0.9569403357322089 },
  { 0.4713967368259978, 0.8819212643483549 },
  { -0.8819212643483549, 0.4713967368259978 },
  { 0.773010453362737, 0.6343932841636455 },
  { -0.6343932841636453, 0.7730104533627371 },
  { 0.09801714032956077, 0.9951847266721968 },
  { -0.9951847266721968, 0.09801714032956084 },
  { 0.9987954562051724, 0.049067674327418015 },
  { -0.04906767432741801, 0.9987954562051724 },
  { 0.6715589548470184, 0.740951125354959 },
  { -0.7409511253549589, 0.6715589548470186 },
  { 0.9039892931234433, 0.4275550934302821 },
  { -0.42755509343028186, 0.9039892931234434 },
  { 0.33688985339222005, 0.9415440651830208 },
  { -0.9415440651830207, 0.3368898533922203 },
  { 0.970031253194544, 0.24298017990326387 },
  { -0.24298017990326387, 0.970031253194544 },
  { 0.5141027441932218, 0.8577286100002721 },
  { -0.8577286100002721, 0.5141027441932218 },
  { 0.8032075314806449, 0.5956993044924334 },
  { -0.5956993044924332, 0.8032075314806449 },
  { 0.14673047445536175, 0.989176509964781 },
  { -0.989176509964781, 0.1467304744553618 },
  { 0.989176509964781, 0.14673047445536175 },
  { -0.14673047445536164, 0.989176509964781 },
  { 0.5956993044924335, 0.8032075314806448 },
  { -0.8032075314806448, 0.5956993044924335 },
  { 0.8577286100002721, 0.5141027441932217 },
  { -0.5141027441932216, 0.8577286100002721 },
  { 0.24298017990326398, 0.970031253194544 },
  { -0.970031253194544, 0.24298017990326404 },
  { 0.9415440651830208, 0.33688985339222005 },
  { -0.33688985339221994, 0.9415440651830208 },
  { 0.4275550934302822, 0.9039892931234433 },
  { -0.9039892931234433, 0.42755509343028203 },
  { 0.7409511253549592, 0.6715589548470183 },
  { -0.6715589548470184, 0.740951125354959 },
  { 0.04906767432741813, 0.9987954562051724 },
  { -0.9987954562051724, 0.04906767432741797 },
  { 0.9996988186962042, 0.024541228522912288 },
  { -0.024541228522912142, 0.9996988186962042 },
  { 0.6895405447370669, 0.7242470829514669 },
  { -0.7242470829514669, 0.689540544737067 },
  { 0.9142097557035307, 0.40524131400498986 },
  { -0.40524131400498975, 0.9142097557035307 },
  { 0.3598950365349883, 0.9329927988347388 },
  { -0.9329927988347388, 0.35989503653498833 },
  { 0.9757021300385286, 0.2191012401568698 },
  { -0.21910124015686966, 0.9757021300385286 },
  { 0.5349976198870974, 0.844853565249707 },
  { -0.8448535652497071, 0.5349976198870972 },
  { 0.8175848131515837, 0.5758081914178453 },
  { -0.5758081914178453, 0.8175848131515837 },
  { 0.17096188876030136, 0.9852776423889412 },
  { -0.9852776423889412, 0.1709618887603012 },
  { 0.99247953459871, 0.1224106751992162 },
  { -0.12241067519921617, 0.99247953459871 },
  { 0.6152315905806269, 0.7883464276266062 },
  { -0.7883464276266062, 0.6152315905806269 },
  { 0.8700869911087115, 0.49289819222978404 },
  { -0.4928981922297839, 0.8700869911087115 },
  { 0.2667127574748984, 0.9637760657954398 },
  { -0.9637760657954398, 0.2667127574748985 },
  { 0.9495281805930367, 0.3136817403988915 },
  { -0.31368174039889146, 0.9495281805930367 },
  { 0.4496113296546066, 0.8932243011955153 },
  { -0.8932243011955152, 0.4496113296546069 },
  { 0.7572088465064846, 0.6531728429537768 },
  { -0.6531728429537765, 0.7572088465064848 },
  { 0.07356456359966745, 0.9972904566786902 },
  { -0.9972904566786902, 0.07356456359966775 },
  { 0.9972904566786902, 0.07356456359966743 },
  { -0.07356456359966734, 0.9972904566786902 },
  { 0.6531728429537769, 0.7572088465064845 },
  { -0.7572088465064847, 0.6531728429537766 },
  { 0.8932243011955153, 0.44961132965460654 },
  { -0.4496113296546067, 0.8932243011955152 },
  { 0.3136817403988915, 0.9495281805930367 },
  { -0.9495281805930367, 0.3136817403988914 },
  { 0.9637760657954398, 0.26671275747489837 },
  { -0.2667127574748983, 0.9637760657954398 },
  { 0.49289819222978415, 0.8700869911087113 },
  { -0.8700869911087113, 0.49289819222978415 },
  { 0.7883464276266063, 0.6152315905806268 },
  { -0.6152315905806267, 0.7883464276266063 },
  { 0.12241067519921628, 0.99247953459871 },
  { -0.99247953459871, 0.12241067519921635 },
  { 0.9852776423889412, 0.17096188876030122 },
  { -0.17096188876030124, 0.9852776423889412 },
  { 0.5758081914178454, 0.8175848131515837 },
  { -0.8175848131515836, 0.5758081914178454 },
  { 0.8448535652497071, 0.5349976198870972 },
  { -0.5349976198870969, 0.8448535652497072 },
  { 0.21910124015686977, 0.9757021300385286 },
  { -0.9757021300385285, 0.21910124015687002 },
  { 0.932992798834739, 0.3598950365349881 },
  { -0.35989503653498817, 0.9329927988347388 },
  { 0.4052413140049898, 0.9142097557035307 },
  { -0.9142097557035307, 0.40524131400498986 },
  { 0.724247082951467, 0.6895405447370668 },
  { -0.6895405447370668, 0.724247082951467 },
  { 0.024541228522912267, 0.9996988186962042 },
  { -0.9996988186962042, 0.024541228522912326 },
  { 0.9999247018391445, 0.012271538285719925 },
  { -0.012271538285719823, 0.9999247018391445 },
  { 0.6983762494089729, 0.7157308252838186 },
  { -0.7157308252838186, 0.6983762494089729 },
  { 0.9191138516900578, 0.3939920400610481 },
  { -0.393992040061048, 0.9191138516900578 },
  { 0.3713171939518376, 0.9285060804732155 },
  { -0.9285060804732155, 0.37131719395183765 },
  { 0.9783173707196277, 0.20711137619221856 },
  { -0.20711137619221845, 0.9783173707196277 },
  { 0.5453249884220466, 0.838224705554838 },
  { -0.8382247055548381, 0.5453249884220464 },
  { 0.8245893027850253, 0.5657318107836131 },
  { -0.5657318107836132, 0.8245893027850253 },
  { 0.18303988795514103, 0.9831054874312163 },
  { -0.9831054874312164, 0.1830398879551409 },
  { 0.9939069700023561, 0.11022220729388306 },
  { -0.11022220729388307, 0.9939069700023561 },
  { 0.6248594881423865, 0.7807372285720944 },
  { -0.7807372285720945, 0.6248594881423863 },
  { 0.8760700941954066, 0.4821837720791227 },
  { -0.4821837720791227, 0.8760700941954066 },
  { 0.27851968938505306, 0.9604305194155658 },
  { -0.9604305194155658, 0.2785196893850531 },
  { 0.9533060403541939, 0.3020059493192281 },
  { -0.3020059493192281, 0.9533060403541939 },
  { 0.46053871095824, 0.8876396204028539 },
  { -0.8876396204028538, 0.4605387109582402 },
  { 0.765167265622459, 0.6438315428897914 },
  { -0.6438315428897913, 0.7651672656224591 },
  { 0.08579731234443988, 0.996312612182778 },
  { -0.996312612182778, 0.08579731234444016 },
  { 0.9981181129001492, 0.06132073630220858 },
  { -0.06132073630220853, 0.9981181129001492 },
  { 0.6624157775901718, 0.7491363945234593 },
  { -0.749136394523459, 0.662415777590172 },
  { 0.8986744656939538, 0.43861623853852766 },
  { -0.4386162385385274, 0.8986744656939539 },
  { 0.325310292162263, 0.9456073253805213 },
  { -0.9456073253805213, 0.3253102921622632 },
  { 0.9669764710448521, 0.25486565960451457 },
  { -0.2548656596045145, 0.9669764710448521 },
  { 0.5035383837257176, 0.8639728561215867 },
  { -0.8639728561215867, 0.5035383837257176 },
  { 0.7958369046088836, 0.6055110414043255 },
  { -0.6055110414043254, 0.7958369046088836 },
  { 0.13458070850712622, 0.99090263542778 },
  { -0.99090263542778, 0.13458070850712628 },
  { 0.9873014181578584, 0.15885814333386145 },
  { -0.15885814333386128, 0.9873014181578584 },
  { 0.5857978574564389, 0.8104571982525948 },
  { -0.8104571982525947, 0.585797857456439 },
  { 0.8513551931052652, 0.524589682678469 },
  { -0.5245896826784687, 0.8513551931052652 },
  { 0.23105810828067125, 0.9729399522055601 },
  { -0.9729399522055601, 0.2310581082806713 },
  { 0.937339011912575, 0.34841868024943456 },
  { -0.3484186802494344, 0.937339011912575 },
  { 0.4164295600976373, 0.9091679830905224 },
  { -0.9091679830905224, 0.41642956009763715 },
  { 0.7326542716724128, 0.680600997795453 },
  { -0.680600997795453, 0.7326542716724128 },
  { 0.03680722294135899, 0.9993223845883495 },
  { -0.9993223845883495, 0.03680722294135883 },
  { 0.9993223845883495, 0.03680722294135883 },
  { -0.036807222941358866, 0.9993223845883495 },
  { 0.6806009977954531, 0.7326542716724127 },
  { -0.7326542716724127, 0.6806009977954532 },
  { 0.9091679830905224, 0.41642956009763715 },
  { -0.416429560097637, 0.9091679830905225 },
  { 0.3484186802494345, 0.937339011912575 },
  { -0.9373390119125748, 0.3484186802494348 },
  { 0.9729399522055602, 0.2310581082806711 },
  { -0.23105810828067117, 0.9729399522055602 },
  { 0.524589682678469, 0.8513551931052652 },
  { -0.8513551931052652, 0.524589682678469 },
  { 0.8104571982525948, 0.5857978574564389 },
  { -0.5857978574564389, 0.8104571982525948 },
  { 0.1588581433338614, 0.9873014181578584 },
  { -0.9873014181578584, 0.15885814333386145 },
  { 0.99090263542778, 0.13458070850712617 },
  { -0.1345807085071261, 0.99090263542778 },
  { 0.6055110414043255, 0.7958369046088835 },
  { -0.7958369046088835, 0.6055110414043255 },
  { 0.8639728561215867, 0.5035383837257176 },
  { -0.5035383837257175, 0.8639728561215868 },
  { 0.2548656596045146, 0.9669764710448521 },
  { -0.9669764710448521, 0.2548656596045147 },
  { 0.9456073253805213, 0.3253102921622629 },
  { -0.32531029216226287, 0.9456073253805214 },
  { 0.4386162385385277, 0.8986744656939538 },
  { -0.8986744656939539, 0.43861623853852755 },
  { 0.7491363945234594, 0.6624157775901718 },
  { -0.6624157775901718, 0.7491363945234593 },
  { 0.061320736302208655, 0.9981181129001492 },
  { -0.9981181129001492, 0.061320736302208495 },
  { 0.996312612182778, 0.0857973123444399 },
  { -0.08579731234443977, 0.996312612182778 },
  { 0.6438315428897915, 0.7651672656224588 },
  { -0.765167265622459, 0.6438315428897914 },
  { 0.8876396204028539, 0.46053871095824 },
  { -0.4605387109582401, 0.8876396204028539 },
  { 0.3020059493192282, 0.9533060403541938 },
  { -0.9533060403541939, 0.30200594931922803 },
  { 0.9604305194155658, 0.27851968938505306 },
  { -0.27851968938505295, 0.9604305194155659 },
  { 0.4821837720791229, 0.8760700941954065 },
  { -0.8760700941954065, 0.4821837720791229 },
  { 0.7807372285720945, 0.6248594881423863 },
  { -0.6248594881423862, 0.7807372285720946 },
  { 0.11022220729388318, 0.9939069700023561 },
  { -0.9939069700023561, 0.11022220729388325 },
  { 0.9831054874312163, 0.18303988795514095 },
  { -0.18303988795514095, 0.9831054874312163 },
  { 0.5657318107836132, 0.8245893027850253 },
  { -0.8245893027850251, 0.5657318107836135 },
  { 0.838224705554838, 0.5453249884220465 },
  { -0.5453249884220461, 0.8382247055548382 },
  { 0.20711137619221856, 0.9783173707196277 },
  { -0.9783173707196275, 0.20711137619221884 },
  { 0.9285060804732156, 0.37131719395183754 },
  { -0.37131719395183754, 0.9285060804732156 },
  { 0.3939920400610481, 0.9191138516900578 },
  { -0.9191138516900578, 0.39399204006104815 },
  { 0.7157308252838186, 0.6983762494089729 },
  { -0.6983762494089728, 0.7157308252838187 },
  { 0.012271538285719944, 0.9999247018391445 },
  { -0.9999247018391445, 0.012271538285720007 },
  { 0.9999811752826011, 0.006135884649154475 },
  { -0.006135884649154393, 0.9999811752826011 },
  { 0.7027547444572254, 0.7114321957452163 },
  { -0.7114321957452165, 0.7027547444572252 },
  { 0.9215140393420419, 0.38834504669882625 },
  { -0.3883450466988262, 0.921514039342042 },
  { 0.3770074102164183, 0.9262102421383114 },
  { -0.9262102421383114, 0.37700741021641815 },
  { 0.9795697656854405, 0.2011046348420919 },
  { -0.20110463484209182, 0.9795697656854405 },
  { 0.5504579729366049, 0.83486287498638 },
  { -0.83486287498638, 0.5504579729366049 },
  { 0.8280450452577558, 0.560661576197336 },
  { -0.5606615761973359, 0.8280450452577559 },
  { 0.18906866414980628, 0.9819638691095552 },
  { -0.9819638691095552, 0.18906866414980633 },
  { 0.9945645707342554, 0.10412163387205459 },
  { -0.10412163387205461, 0.9945645707342554 },
  { 0.6296382389149271, 0.7768884656732324 },
  { -0.7768884656732323, 0.6296382389149272 },
  { 0.8790122264286335, 0.4767992300633221 },
  { -0.476799230063322, 0.8790122264286335 },
  { 0.2844075372112718, 0.9587034748958716 },
  { -0.9587034748958715, 0.28440753721127204 },
  { 0.9551411683057707, 0.2961508882436238 },
  { -0.29615088824362384, 0.9551411683057707 },
  { 0.4659764957679661, 0.8847970984309378 },
  { -0.8847970984309378, 0.4659764957679662 },
  { 0.7691033376455797, 0.6391244448637757 },
  { -0.6391244448637757, 0.7691033376455797 },
  { 0.0919089564971327, 0.9957674144676598 },
  { -0.9957674144676598, 0.09190895649713277 },
  { 0.9984755805732948, 0.05519524434968994 },
  { -0.05519524434968991, 0.9984755805732948 },
  { 0.6669999223036376, 0.745057785441466 },
  { -0.745057785441466, 0.6669999223036376 },
  { 0.901348847046022, 0.43309381885315196 },
  { -0.43309381885315196, 0.901348847046022 },
  { 0.33110630575987643, 0.9435934581619604 },
  { -0.9435934581619604, 0.3311063057598765 },
  { 0.9685220942744173, 0.24892760574572015 },
  { -0.24892760574572015, 0.9685220942744173 },
  { 0.5088301425431071, 0.8608669386377672 },
  { -0.8608669386377672, 0.5088301425431073 },
  { 0.799537269107905, 0.600616479383869 },
  { -0.6006164793838686, 0.7995372691079052 },
  { 0.14065823933284924, 0.9900582102622971 },
  { -0.990058210262297, 0.14065823933284952 },
  { 0.9882575677307495, 0.15279718525844344 },
  { -0.1527971852584433, 0.9882575677307495 },
  { 0.5907597018588743, 0.8068475535437992 },
  { -0.8068475535437993, 0.5907597018588742 },
  { 0.8545579883654005, 0.5193559901655896 },
  { -0.5193559901655896, 0.8545579883654005 },
  { 0.23702360599436734, 0.9715038909862518 },
  { -0.9715038909862518, 0.23702360599436717 },
  { 0.9394592236021899, 0.3426607173119944 },
  { -0.34266071731199427, 0.9394592236021899 },
  { 0.4220002707997998, 0.9065957045149153 },
  { -0.9065957045149153, 0.42200027079979985 },
  { 0.7368165688773698, 0.6760927035753159 },
  { -0.6760927035753158, 0.73681656887737 },
  { 0.04293825693494096, 0.9990777277526454 },
  { -0.9990777277526454, 0.04293825693494102 },
  { 0.9995294175010931, 0.030674803176636626 },
  { -0.03067480317663646, 0.9995294175010931 },
  { 0.6850836677727005, 0.7284643904482252 },
  { -0.7284643904482252, 0.6850836677727004 },
  { 0.9117060320054299, 0.4108431710579039 },
  { -0.4108431710579038, 0.9117060320054299 },
  { 0.3541635254204905, 0.9351835099389475 },
  { -0.9351835099389476, 0.35416352542049034 },
  { 0.9743393827855759, 0.22508391135979283 },
  { -0.22508391135979267, 0.9743393827855759 },
  { 0.5298036246862948, 0.8481203448032971 },
  { -0.8481203448032971, 0.5298036246862948 },
  { 0.8140363297059484, 0.5808139580957645 },
  { -0.5808139580957643, 0.8140363297059485 },
  { 0.16491312048997006, 0.9863080972445987 },
  { -0.9863080972445986, 0.16491312048997012 },
  { 0.9917097536690995, 0.12849811079379317 },
  { -0.1284981107937931, 0.9917097536690995 },
  { 0.6103828062763095, 0.7921065773002123 },
  { -0.7921065773002122, 0.6103828062763097 },
  { 0.8670462455156926, 0.49822766697278187 },
  { -0.49822766697278154, 0.8670462455156929 },
  { 0.26079411791527557, 0.9653944416976894 },
  { -0.9653944416976893, 0.26079411791527585 },
  { 0.9475855910177411, 0.3195020308160157 },
  { -0.31950203081601564, 0.9475855910177412 },
  { 0.44412214457042926, 0.8959662497561851 },
  { -0.8959662497561851, 0.4441221445704293 },
  { 0.7531867990436125, 0.6578066932970786 },
  { -0.6578066932970785, 0.7531867990436125 },
  { 0.0674439195636641, 0.9977230666441916 },
  { -0.9977230666441916, 0.06744391956366418 },
  { 0.9968202992911657, 0.07968243797143013 },
  { -0.07968243797143001, 0.9968202992911657 },
  { 0.6485144010221126, 0.7612023854842618 },
  { -0.7612023854842618, 0.6485144010221126 },
  { 0.8904487232447579, 0.45508358712634384 },
  { -0.4550835871263437, 0.890448723244758 },
  { 0.307849640041535, 0.9514350209690083 },
  { -0.9514350209690083, 0.30784964004153503 },
  { 0.9621214042690416, 0.272621355449949 },
  { -0.27262135544994887, 0.9621214042690416 },
  { 0.4875501601484361, 0.87309497841829 },
  { -0.8730949784182902, 0.4875501601484359 },
  { 0.7845565971555752, 0.6200572117632891 },
  { -0.6200572117632892, 0.7845565971555752 },
  { 0.11631863091190486, 0.9932119492347945 },
  { -0.9932119492347945, 0.11631863091190471 },
  { 0.984210092386929, 0.17700422041214875 },
  { -0.17700422041214875, 0.984210092386929 },
  { 0.5707807458869674, 0.8211025149911046 },
  { -0.8211025149911046, 0.5707807458869673 },
  { 0.8415549774368984, 0.5401714727298929 },
  { -0.5401714727298929, 0.8415549774368984 },
  { 0.21311031991609136, 0.9770281426577544 },
  { -0.9770281426577544, 0.21311031991609142 },
  { 0.9307669610789837, 0.36561299780477385 },
  { -0.36561299780477385, 0.9307669610789837 },
  { 0.3996241998456468, 0.9166790599210427 },
  { -0.9166790599210426, 0.39962419984564707 },
  { 0.7200025079613817, 0.6939714608896539 },
  { -0.6939714608896538, 0.7200025079613819 },
  { 0.01840672990580482, 0.9998305817958234 },
  { -0.9998305817958234, 0.0184067299058051 },
  { 0.9998305817958234, 0.01840672990580482 },
  { -0.018406729905804695, 0.9998305817958234 },
  { 0.693971460889654, 0.7200025079613817 },
  { -0.7200025079613817, 0.6939714608896539 },
  { 0.9166790599210427, 0.3996241998456468 },
  { -0.39962419984564673, 0.9166790599210427 },
  { 0.36561299780477396, 0.9307669610789837 },
  { -0.9307669610789837, 0.3656129978047738 },
  { 0.9770281426577544, 0.21311031991609136 },
  { -0.21311031991609125, 0.9770281426577544 },
  { 0.540171472729893, 0.8415549774368983 },
  { -0.8415549774368983, 0.540171472729893 },
  { 0.8211025149911046, 0.5707807458869673 },
  { -0.5707807458869671, 0.8211025149911048 },
  { 0.17700422041214886, 0.984210092386929 },
  { -0.984210092386929, 0.17700422041214892 },
  { 0.9932119492347945, 0.11631863091190475 },
  { -0.11631863091190475, 0.9932119492347945 },
  { 0.6200572117632892, 0.7845565971555752 },
  { -0.7845565971555751, 0.6200572117632894 },
  { 0.8730949784182901, 0.487550160148436 },
  { -0.4875501601484357, 0.8730949784182902 },
  { 0.272621355449949, 0.9621214042690416 },
  { -0.9621214042690416, 0.27262135544994925 },
  { 0.9514350209690083, 0.30784964004153487 },
  { -0.30784964004153487, 0.9514350209690083 },
  { 0.45508358712634384, 0.8904487232447579 },
  { -0.8904487232447579, 0.4550835871263439 },
  { 0.7612023854842618, 0.6485144010221124 },
  { -0.6485144010221124, 0.7612023854842619 },
  { 0.07968243797143013, 0.9968202992911657 },
  { -0.9968202992911657, 0.0796824379714302 },
  { 0.9977230666441916, 0.06744391956366405 },
  { -0.067443919563664, 0.9977230666441916 },
  { 0.6578066932970787, 0.7531867990436124 },
  { -0.7531867990436124, 0.6578066932970787 },
  { 0.8959662497561852, 0.4441221445704292 },
  { -0.44412214457042914, 0.8959662497561852 },
  { 0.31950203081601575, 0.9475855910177411 },
  { -0.9475855910177411, 0.3195020308160158 },
  { 0.9653944416976894, 0.2607941179152755 },
  { -0.26079411791527546, 0.9653944416976894 },
  { 0.4982276669727819, 0.8670462455156926 },
  { -0.8670462455156926, 0.49822766697278176 },
  { 0.7921065773002124, 0.6103828062763095 },
  { -0.6103828062763095, 0.7921065773002123 },
  { 0.12849811079379322, 0.9917097536690995 },
  { -0.9917097536690995, 0.12849811079379306 },
  { 0.9863080972445987, 0.16491312048996992 },
  { -0.16491312048996995, 0.9863080972445987 },
  { 0.5808139580957646, 0.8140363297059483 },
  { -0.8140363297059484, 0.5808139580957645 },
  { 0.8481203448032972, 0.5298036246862946 },
  { -0.5298036246862946, 0.8481203448032972 },
  { 0.22508391135979278, 0.9743393827855759 },
  { -0.9743393827855759, 0.22508391135979283 },
  { 0.9351835099389476, 0.35416352542049034 },
  { -0.3541635254204904, 0.9351835099389476 },
  { 0.4108431710579039, 0.9117060320054299 },
  { -0.9117060320054298, 0.41084317105790413 },
  { 0.7284643904482252, 0.6850836677727004 },
  { -0.6850836677727002, 0.7284643904482253 },
  { 0.030674803176636584, 0.9995294175010931 },
  { -0.9995294175010931, 0.030674803176636865 },
  { 0.9990777277526454, 0.04293825693494082 },
  { -0.042938256934940834, 0.9990777277526454 },
  { 0.676092703575316, 0.7368165688773698 },
  { -0.7368165688773698, 0.6760927035753159 },
  { 0.9065957045149153, 0.4220002707997997 },
  { -0.4220002707997997, 0.9065957045149153 },
  { 0.3426607173119944, 0.9394592236021899 },
  { -0.9394592236021899, 0.34266071731199443 },
  { 0.9715038909862518, 0.2370236059943672 },
  { -0.23702360599436723, 0.9715038909862518 },
  { 0.5193559901655896, 0.8545579883654005 },
  { -0.8545579883654004, 0.5193559901655898 },
  { 0.8068475535437993, 0.5907597018588742 },
  { -0.590759701858874, 0.8068475535437994 },
  { 0.1527971852584434, 0.9882575677307495 },
  { -0.9882575677307495, 0.15279718525844369 },
  { 0.9900582102622971, 0.1406582393328492 },
  { -0.14065823933284913, 0.9900582102622971 },
  { 0.600616479383869, 0.799537269107905 },
  { -0.799537269107905, 0.6006164793838689 },
  { 0.8608669386377673, 0.508830142543107 },
  { -0.5088301425431071, 0.8608669386377672 },
  { 0.24892760574572026, 0.9685220942744173 },
  { -0.9685220942744174, 0.2489276057457201 },
  { 0.9435934581619604, 0.33110630575987643 },
  { -0.3311063057598763, 0.9435934581619604 },
  { 0.433093818853152, 0.901348847046022 },
  { -0.9013488470460219, 0.43309381885315207 },
  { 0.745057785441466, 0.6669999223036375 },
  { -0.6669999223036374, 0.7450577854414661 },
  { 0.05519524434969003, 0.9984755805732948 },
  { -0.9984755805732948, 0.055195244349690094 },
  { 0.9957674144676598, 0.09190895649713272 },
  { -0.09190895649713259, 0.9957674144676598 },
  { 0.6391244448637758, 0.7691033376455796 },
  { -0.7691033376455796, 0.6391244448637758 },
  { 0.8847970984309378, 0.4659764957679662 },
  { -0.465976495767966, 0.8847970984309379 },
  { 0.29615088824362396, 0.9551411683057707 },
  { -0.9551411683057707, 0.296150888243624 },
  { 0.9587034748958716, 0.2844075372112719 },
  { -0.2844075372112717, 0.9587034748958716 },
  { 0.47679923006332225, 0.8790122264286334 },
  { -0.8790122264286335, 0.4767992300633221 },
  { 0.7768884656732324, 0.629638238914927 },
  { -0.629638238914927, 0.7768884656732324 },
  { 0.10412163387205473, 0.9945645707342554 },
  { -0.9945645707342554, 0.10412163387205457 },
  { 0.9819638691095552, 0.1890686641498062 },
  { -0.18906866414980616, 0.9819638691095552 },
  { 0.560661576197336, 0.8280450452577557 },
  { -0.8280450452577557, 0.560661576197336 },
  { 0.83486287498638, 0.5504579729366048 },
  { -0.5504579729366047, 0.8348628749863801 },
  { 0.20110463484209193, 0.9795697656854405 },
  { -0.9795697656854405, 0.20110463484209198 },
  { 0.9262102421383114, 0.37700741021641826 },
  { -0.3770074102164182, 0.9262102421383114 },
  { 0.3883450466988263, 0.9215140393420419 },
  { -0.9215140393420418, 0.3883450466988266 },
  { 0.7114321957452164, 0.7027547444572253 },
  { -0.7027547444572251, 0.7114321957452168 },
  { 0.006135884649154516, 0.9999811752826011 },
  { -0.9999811752826011, 0.006135884649154799 },
  { 0.9999952938095762, 0.003067956762965976 },
  { -0.0030679567629660156, 0.9999952938095762 },
  { 0.704934080375905, 0.7092728264388656 },
  { -0.7092728264388655, 0.7049340803759051 },
  { 0.9227011283338786, 0.38551605384391885 },
  { -0.3855160538439189, 0.9227011283338785 },
  { 0.3798472089240511, 0.9250492407826776 },
  { -0.9250492407826775, 0.3798472089240514 },
  { 0.9801821359681174, 0.19809841071795356 },
  { -0.19809841071795362, 0.9801821359681174 },
  { 0.5530167055800276, 0.8331701647019132 },
  { -0.8331701647019132, 0.5530167055800275 },
  { 0.829761233794523, 0.5581185312205561 },
  { -0.5581185312205561, 0.829761233794523 },
  { 0.19208039704989238, 0.9813791933137546 },
  { -0.9813791933137546, 0.19208039704989244 },
  { 0.9948793307948056, 0.10106986275482782 },
  { -0.10106986275482775, 0.9948793307948056 },
  { 0.6320187359398091, 0.7749531065948738 },
  { -0.7749531065948738, 0.6320187359398091 },
  { 0.8804708890521608, 0.47410021465054997 },
  { -0.47410021465054997, 0.8804708890521609 },
  { 0.28734745954472957, 0.9578264130275329 },
  { -0.9578264130275329, 0.2873474595447296 },
  { 0.9560452513499964, 0.29321916269425863 },
  { -0.2932191626942586, 0.9560452513499965 },
  { 0.46868882203582796, 0.8833633386657316 },
  { -0.8833633386657317, 0.46868882203582785 },
  { 0.7710605242618138, 0.6367618612362842 },
  { -0.6367618612362843, 0.7710605242618137 },
  { 0.09496349532963906, 0.9954807554919269 },
  { -0.9954807554919269, 0.09496349532963891 },
  { 0.9986402181802653, 0.052131704680283324 },
  { -0.05213170468028319, 0.9986402181802653 },
  { 0.6692825883466361, 0.7430079521351216 },
  { -0.7430079521351217, 0.669282588346636 },
  { 0.9026733182372588, 0.4303264813400826 },
  { -0.4303264813400827, 0.9026733182372588 },
  { 0.3339996514420095, 0.9425731976014469 },
  { -0.9425731976014469, 0.3339996514420093 },
  { 0.9692812353565485, 0.2459550503357946 },
  { -0.24595505033579448, 0.9692812353565485 },
  { 0.5114688504379705, 0.8593018183570083 },
  { -0.8593018183570083, 0.5114688504379705 },
  { 0.8013761717231402, 0.5981607069963424 },
  { -0.5981607069963422, 0.8013761717231404 },
  { 0.14369503315029458, 0.9896220174632008 },
  { -0.9896220174632008, 0.14369503315029464 },
  { 0.9887216919603238, 0.1497645346773215 },
  { -0.1497645346773215, 0.9887216919603238 },
  { 0.5932322950397999, 0.8050313311429635 },
  { -0.8050313311429634, 0.5932322950398 },
  { 0.8561473283751945, 0.5167317990176499 },
  { -0.5167317990176497, 0.8561473283751946 },
  { 0.2400030224487415, 0.9707721407289504 },
  { -0.9707721407289502, 0.24000302244874175 },
  { 0.9405060705932683, 0.33977688440682685 },
  { -0.33977688440682685, 0.9405060705932683 },
  { 0.4247796812091088, 0.9052967593181188 },
  { -0.9052967593181187, 0.42477968120910886 },
  { 0.7388873244606151, 0.673829000378756 },
  { -0.673829000378756, 0.7388873244606152 },
  { 0.046003182130914644, 0.9989412931868569 },
  { -0.9989412931868569, 0.046003182130914706 },
  { 0.9996188224951786, 0.02760814577896574 },
  { -0.027608145778965695, 0.9996188224951786 },
  { 0.6873153408917592, 0.7263591550843459 },
  { -0.7263591550843458, 0.6873153408917593 },
  { 0.9129621904283982, 0.4080441628649787 },
  { -0.40804416286497863, 0.9129621904283982 },
  { 0.35703096123343003, 0.9340925504042589 },
  { -0.9340925504042588, 0.3570309612334303 },
  { 0.9750253450669941, 0.2220936209732035 },
  { -0.22209362097320348, 0.9750253450669941 },
  { 0.532403127877198, 0.846490938774052 },
  { -0.846490938774052, 0.532403127877198 },
  { 0.8158144108067338, 0.5783137964116556 },
  { -0.5783137964116555, 0.8158144108067339 },
  { 0.1679382949747312, 0.9857975091675674 },
  { -0.9857975091675674, 0.16793829497473126 },
  { 0.9920993131421918, 0.12545498341154623 },
  { -0.1254549834115461, 0.9920993131421918 },
  { 0.6128100824294098, 0.79023022143731 },
  { -0.7902302214373099, 0.6128100824294098 },
  { 0.8685707059713409, 0.49556526182577254 },
  { -0.4955652618257723, 0.868570705971341 },
  { 0.2637546789748315, 0.9645897932898126 },
  { -0.9645897932898126, 0.26375467897483157 },
  { 0.9485613499157303, 0.31659337555616585 },
  { -0.31659337555616573, 0.9485613499157304 },
  { 0.4468688401623743, 0.8945994856313826 },
  { -0.8945994856313827, 0.44686884016237416 },
  { 0.7552013768965365, 0.6554928529996153 },
  { -0.6554928529996153, 0.7552013768965365 },
  { 0.07050457338961401, 0.9975114561403035 },
  { -0.9975114561403035, 0.07050457338961386 },
  { 0.997060070339483, 0.07662386139203149 },
  { -0.0766238613920315, 0.997060070339483 },
  { 0.650846684996381, 0.759209188978388 },
  { -0.759209188978388, 0.650846684996381 },
  { 0.8918407093923427, 0.4523495872337709 },
  { -0.4523495872337709, 0.8918407093923427 },
  { 0.3107671527496115, 0.9504860739494817 },
  { -0.9504860739494817, 0.31076715274961153 },
  { 0.9629532668736839, 0.2696683255729151 },
  { -0.2696683255729151, 0.9629532668736839 },
  { 0.49022648328829116, 0.871595086655951 },
  { -0.871595086655951, 0.4902264832882914 },
  { 0.7864552135990858, 0.6176473079378039 },
  { -0.6176473079378038, 0.7864552135990859 },
  { 0.11936521481099134, 0.9928504144598651 },
  { -0.9928504144598651, 0.11936521481099163 },
  { 0.9847485018019042, 0.17398387338746382 },
  { -0.17398387338746374, 0.9847485018019042 },
  { 0.5732971666980423, 0.8193475200767969 },
  { -0.819347520076797, 0.5732971666980421 },
  { 0.8432082396418454, 0.5375870762956454 },
  { -0.5375870762956455, 0.8432082396418454 },
  { 0.2161067970762196, 0.9763697313300211 },
  { -0.9763697313300211, 0.21610679707621944 },
  { 0.9318842655816681, 0.3627557243673972 },
  { -0.3627557243673971, 0.9318842655816681 },
  { 0.40243465085941854, 0.9154487160882678 },
  { -0.9154487160882677, 0.40243465085941854 },
  { 0.7221281939292153, 0.6917592583641577 },
  { -0.6917592583641576, 0.7221281939292155 },
  { 0.02147408027546961, 0.9997694053512153 },
  { -0.9997694053512153, 0.021474080275469667 },
  { 0.9998823474542126, 0.0153392062849881 },
  { -0.015339206284988098, 0.9998823474542126 },
  { 0.6961771314914631, 0.7178700450557316 },
  { -0.7178700450557316, 0.6961771314914631 },
  { 0.9179007756213905, 0.3968099874167103 },
  { -0.3968099874167103, 0.9179007756213905 },
  { 0.3684668299533723, 0.9296408958431812 },
  { -0.9296408958431812, 0.3684668299533726 },
  { 0.9776773578245099, 0.2101118368804696 },
  { -0.2101118368804696, 0.9776773578245099 },
  { 0.542750784864516, 0.8398937941959994 },
  { -0.8398937941959995, 0.5427507848645159 },
  { 0.8228497813758264, 0.5682589526701315 },
  { -0.5682589526701315, 0.8228497813758264 },
  { 0.18002290140569951, 0.9836624192117303 },
  { -0.9836624192117303, 0.18002290140569957 },
  { 0.9935641355205953, 0.11327095217756435 },
  { -0.11327095217756424, 0.9935641355205953 },
  { 0.6224612793741501, 0.7826505961665756 },
  { -0.7826505961665756, 0.6224612793741501 },
  { 0.8745866522781762, 0.48486924800079106 },
  { -0.48486924800079095, 0.8745866522781762 },
  { 0.27557181931095825, 0.9612804858113206 },
  { -0.9612804858113206, 0.2755718193109583 },
  { 0.9523750127197659, 0.3049292297354024 },
  { -0.3049292297354023, 0.9523750127197659 },
  { 0.4578133035988773, 0.8890483558546645 },
  { -0.8890483558546646, 0.4578133035988772 },
  { 0.7631884172633814, 0.6461760129833163 },
  { -0.6461760129833164, 0.7631884172633813 },
  { 0.0827402645493758, 0.9965711457905548 },
  { -0.9965711457905548, 0.08274026454937565 },
  { 0.997925286198596, 0.06438263092985747 },
  { -0.0643826309298573, 0.997925286198596 },
  { 0.6601143420674206, 0.7511651319096864 },
  { -0.7511651319096864, 0.6601143420674205 },
  { 0.8973245807054183, 0.44137126873171667 },
  { -0.4413712687317167, 0.8973245807054182 },
  { 0.32240767880106996, 0.9466009130832835 },
  { -0.9466009130832835, 0.32240767880106985 },
  { 0.9661900034454125, 0.257831102162159 },
  { -0.2578311021621588, 0.9661900034454126 },
  { 0.5008853826112409, 0.865513624090569 },
  { -0.865513624090569, 0.5008853826112409 },
  { 0.7939754775543372, 0.6079497849677736 },
  { -0.6079497849677735, 0.7939754775543373 },
  { 0.13154002870288325, 0.9913108598461154 },
  { -0.9913108598461154, 0.1315400287028833 },
  { 0.9868094018141855, 0.16188639378011183 },
  { -0.16188639378011177, 0.9868094018141855 },
  { 0.5833086529376984, 0.8122505865852039 },
  { -0.8122505865852037, 0.5833086529376985 },
  { 0.8497417680008525, 0.5271991347819014 },
  { -0.5271991347819011, 0.8497417680008527 },
  { 0.2280720831708858, 0.9736442496508119 },
  { -0.9736442496508119, 0.22807208317088606 },
  { 0.9362656671702783, 0.3512927560855671 },
  { -0.35129275608556704, 0.9362656671702783 },
  { 0.41363831223843456, 0.9104412922580671 },
  { -0.9104412922580671, 0.4136383122384346 },
  { 0.7305627692278276, 0.6828455463852481 },
  { -0.682845546385248, 0.7305627692278276 },
  { 0.03374117185137764, 0.9994306045554617 },
  { -0.9994306045554617, 0.033741171851377705 },
  { 0.9992047586183639, 0.03987292758773981 },
  { -0.03987292758773972, 0.9992047586183639 },
  { 0.6783500431298616, 0.7347388780959634 },
  { -0.7347388780959636, 0.6783500431298615 },
  { 0.9078861164876663, 0.4192168883632239 },
  { -0.41921688836322407, 0.9078861164876662 },
  { 0.34554132496398915, 0.9384035340631081 },
  { -0.9384035340631082, 0.345541324963989 },
  { 0.9722264970789363, 0.23404195858354343 },
  { -0.23404195858354335, 0.9722264970789363 },
  { 0.5219752929371544, 0.8529606049303636 },
  { -0.8529606049303636, 0.5219752929371544 },
  { 0.808656181588175, 0.5882815482226452 },
  { -0.5882815482226452, 0.8086561815881751 },
  { 0.15582839765426532, 0.9877841416445722 },
  { -0.9877841416445722, 0.15582839765426537 },
  { 0.9904850842564571, 0.13762012158648604 },
  { -0.13762012158648607, 0.990485084256457 },
  { 0.6030665985403483, 0.797690840943391 },
  { -0.7976908409433909, 0.6030665985403484 },
  { 0.8624239561110405, 0.5061866453451552 },
  { -0.5061866453451551, 0.8624239561110407 },
  { 0.2518978181542169, 0.9677538370934755 },
  { -0.9677538370934754, 0.2518978181542172 },
  { 0.9446048372614803, 0.3282098435790925 },
  { -0.32820984357909255, 0.9446048372614803 },
  { 0.4358570799222555, 0.9000158920161603 },
  { -0.9000158920161603, 0.4358570799222555 },
  { 0.7471006059801801, 0.6647109782033448 },
  { -0.6647109782033448, 0.7471006059801801 },
  { 0.05825826450043573, 0.9983015449338929 },
  { -0.9983015449338929, 0.058258264500435794 },
  { 0.996044700901252, 0.0888535525825246 },
  { -0.08885355258252457, 0.996044700901252 },
  { 0.6414810128085832, 0.7671389119358203 },
  { -0.7671389119358203, 0.6414810128085832 },
  { 0.8862225301488806, 0.46325978355186015 },
  { -0.46325978355186015, 0.8862225301488806 },
  { 0.2990798263080405, 0.9542280951091057 },
  { -0.9542280951091056, 0.29907982630804053 },
  { 0.9595715130819845, 0.28146493792575794 },
  { -0.28146493792575794, 0.9595715130819845 },
  { 0.47949375766015306, 0.8775452902072612 },
  { -0.8775452902072611, 0.4794937576601533 },
  { 0.778816512381476, 0.6272518154951441 },
  { -0.6272518154951439, 0.7788165123814762 },
  { 0.10717242495680887, 0.9942404494531879 },
  { -0.9942404494531879, 0.10717242495680916 },
  { 0.9825393022874412, 0.18605515166344663 },
  { -0.18605515166344652, 0.9825393022874412 },
  { 0.5631993440138342, 0.8263210628456634 },
  { -0.8263210628456635, 0.5631993440138341 },
  { 0.836547727223512, 0.5478940591731002 },
  { -0.5478940591731002, 0.836547727223512 },
  { 0.204108966092817, 0.9789481753190622 },
  { -0.9789481753190622, 0.20410896609281684 },
  { 0.9273625256504011, 0.37416406297145793 },
  { -0.3741640629714579, 0.9273625256504011 },
  { 0.391170384302254, 0.9203182767091105 },
  { -0.9203182767091105, 0.39117038430225404 },
  { 0.7135848687807935, 0.7005687939432483 },
  { -0.7005687939432482, 0.7135848687807937 },
  { 0.00920375478205996, 0.9999576445519639 },
  { -0.9999576445519639, 0.009203754782060022 },
  { 0.9999576445519639, 0.00920375478205982 },
  { -0.009203754782059839, 0.9999576445519639 },
  { 0.7005687939432484, 0.7135848687807935 },
  { -0.7135848687807935, 0.7005687939432483 },
  { 0.9203182767091106, 0.39117038430225387 },
  { -0.39117038430225387, 0.9203182767091106 },
  { 0.37416406297145793, 0.9273625256504011 },
  { -0.9273625256504011, 0.374164062971458 },
  { 0.9789481753190622, 0.20410896609281687 },
  { -0.2041089660928169, 0.9789481753190622 },
  { 0.5478940591731003, 0.8365477272235119 },
  { -0.8365477272235119, 0.5478940591731003 },
  { 0.8263210628456635, 0.5631993440138341 },
  { -0.5631993440138339, 0.8263210628456636 },
  { 0.1860551516634466, 0.9825393022874412 },
  { -0.9825393022874412, 0.18605515166344688 },
  { 0.9942404494531879, 0.10717242495680884 },
  { -0.10717242495680876, 0.9942404494531879 },
  { 0.6272518154951442, 0.7788165123814759 },
  { -0.7788165123814761, 0.6272518154951441 },
  { 0.8775452902072614, 0.479493757660153 },
  { -0.47949375766015306, 0.8775452902072612 },
  { 0.28146493792575805, 0.9595715130819845 },
  { -0.9595715130819845, 0.2814649379257579 },
  { 0.9542280951091057, 0.2990798263080405 },
  { -0.29907982630804036, 0.9542280951091057 },
  { 0.46325978355186026, 0.8862225301488806 },
  { -0.8862225301488805, 0.4632597835518603 },
  { 0.7671389119358204, 0.6414810128085832 },
  { -0.641481012808583, 0.7671389119358205 },
  { 0.08885355258252468, 0.996044700901252 },
  { -0.996044700901252, 0.08885355258252475 },
  { 0.9983015449338929, 0.05825826450043575 },
  { -0.05825826450043561, 0.9983015449338929 },
  { 0.6647109782033449, 0.7471006059801801 },
  { -0.74710060598018, 0.664710978203345 },
  { 0.9000158920161603, 0.4358570799222555 },
  { -0.43585707992225536, 0.9000158920161603 },
  { 0.32820984357909266, 0.9446048372614803 },
  { -0.9446048372614801, 0.3282098435790927 },
  { 0.9677538370934755, 0.25189781815421697 },
  { -0.2518978181542168, 0.9677538370934755 },
  { 0.5061866453451555, 0.8624239561110405 },
  { -0.8624239561110405, 0.5061866453451552 },
  { 0.7976908409433912, 0.6030665985403482 },
  { -0.6030665985403482, 0.7976908409433912 },
  { 0.13762012158648618, 0.990485084256457 },
  { -0.9904850842564571, 0.137620121586486 },
  { 0.9877841416445722, 0.15582839765426523 },
  { -0.1558283976542652, 0.9877841416445722 },
  { 0.5882815482226453, 0.808656181588175 },
  { -0.808656181588175, 0.5882815482226453 },
  { 0.8529606049303636, 0.5219752929371544 },
  { -0.5219752929371543, 0.8529606049303637 },
  { 0.23404195858354346, 0.9722264970789363 },
  { -0.9722264970789363, 0.23404195858354349 },
  { 0.9384035340631081, 0.3455413249639891 },
  { -0.34554132496398904, 0.9384035340631082 },
  { 0.41921688836322396, 0.9078861164876662 },
  { -0.907886116487666, 0.41921688836322424 },
  { 0.7347388780959634, 0.6783500431298615 },
  { -0.6783500431298612, 0.7347388780959637 },
  { 0.039872927587739845, 0.9992047586183639 },
  { -0.9992047586183639, 0.03987292758774013 },
  { 0.9994306045554617, 0.03374117185137758 },
  { -0.03374117185137752, 0.9994306045554617 },
  { 0.6828455463852481, 0.7305627692278276 },
  { -0.7305627692278276, 0.6828455463852481 },
  { 0.9104412922580672, 0.41363831223843456 },
  { -0.4136383122384345, 0.9104412922580672 },
  { 0.35129275608556715, 0.9362656671702783 },
  { -0.9362656671702783, 0.3512927560855672 },
  { 0.973644249650812, 0.22807208317088573 },
  { -0.22807208317088568, 0.973644249650812 },
  { 0.5271991347819014, 0.8497417680008524 },
  { -0.8497417680008525, 0.5271991347819013 },
  { 0.8122505865852039, 0.5833086529376983 },
  { -0.5833086529376984, 0.8122505865852039 },
  { 0.16188639378011188, 0.9868094018141854 },
  { -0.9868094018141855, 0.16188639378011171 },
  { 0.9913108598461154, 0.13154002870288312 },
  { -0.13154002870288317, 0.9913108598461154 },
  { 0.6079497849677737, 0.7939754775543371 },
  { -0.7939754775543372, 0.6079497849677736 },
  { 0.8655136240905691, 0.5008853826112407 },
  { -0.5008853826112407, 0.8655136240905691 },
  { 0.25783110216215893, 0.9661900034454126 },
  { -0.9661900034454125, 0.257831102162159 },
  { 0.9466009130832835, 0.32240767880106985 },
  { -0.3224076788010699, 0.9466009130832835 },
  { 0.4413712687317166, 0.8973245807054183 },
  { -0.8973245807054182, 0.4413712687317169 },
  { 0.7511651319096864, 0.6601143420674205 },
  { -0.6601143420674203, 0.7511651319096866 },
  { 0.06438263092985741, 0.997925286198596 },
  { -0.997925286198596, 0.0643826309298577 },
  { 0.9965711457905548, 0.08274026454937569 },
  { -0.08274026454937569, 0.9965711457905548 },
  { 0.6461760129833164, 0.7631884172633813 },
  { -0.7631884172633812, 0.6461760129833165 },
  { 0.8890483558546646, 0.45781330359887723 },
  { -0.457813303598877, 0.8890483558546647 },
  { 0.3049292297354024, 0.9523750127197659 },
  { -0.9523750127197658, 0.30492922973540265 },
  { 0.9612804858113206, 0.27557181931095814 },
  { -0.27557181931095814, 0.9612804858113206 },
  { 0.4848692480007911, 0.8745866522781761 },
  { -0.8745866522781761, 0.4848692480007911 },
  { 0.7826505961665757, 0.62246127937415 },
  { -0.62246127937415, 0.7826505961665757 },
  { 0.11327095217756435, 0.9935641355205953 },
  { -0.9935641355205953, 0.11327095217756442 },
  { 0.9836624192117303, 0.18002290140569951 },
  { -0.1800229014056994, 0.9836624192117303 },
  { 0.5682589526701316, 0.8228497813758263 },
  { -0.8228497813758262, 0.5682589526701317 },
  { 0.8398937941959995, 0.5427507848645159 },
  { -0.5427507848645158, 0.8398937941959996 },
  { 0.21011183688046972, 0.9776773578245099 },
  { -0.9776773578245099, 0.21011183688046978 },
  { 0.9296408958431812, 0.3684668299533723 },
  { -0.3684668299533722, 0.9296408958431813 },
  { 0.3968099874167104, 0.9179007756213904 },
  { -0.9179007756213905, 0.39680998741671025 },
  { 0.7178700450557317, 0.696177131491463 },
  { -0.696177131491463, 0.7178700450557317 },
  { 0.01533920628498822, 0.9998823474542126 },
  { -0.9998823474542126, 0.01533920628498806 },
  { 0.9997694053512153, 0.021474080275469508 },
  { -0.021474080275469484, 0.9997694053512153 },
  { 0.6917592583641579, 0.7221281939292152 },
  { -0.7221281939292152, 0.6917592583641579 },
  { 0.9154487160882678, 0.40243465085941843 },
  { -0.40243465085941843, 0.9154487160882678 },
  { 0.3627557243673972, 0.9318842655816681 },
  { -0.9318842655816681, 0.3627557243673973 },
  { 0.9763697313300211, 0.21610679707621952 },
  { -0.2161067970762195, 0.9763697313300211 },
  { 0.5375870762956455, 0.8432082396418454 },
  { -0.8432082396418453, 0.5375870762956457 },
  { 0.819347520076797, 0.5732971666980422 },
  { -0.573297166698042, 0.8193475200767971 },
  { 0.17398387338746385, 0.9847485018019042 },
  { -0.9847485018019042, 0.1739838733874641 },
  { 0.9928504144598651, 0.11936521481099135 },
  { -0.11936521481099123, 0.9928504144598651 },
  { 0.617647307937804, 0.7864552135990858 },
  { -0.7864552135990858, 0.6176473079378039 },
  { 0.871595086655951, 0.49022648328829116 },
  { -0.49022648328829116, 0.871595086655951 },
  { 0.2696683255729152, 0.9629532668736839 },
  { -0.9629532668736839, 0.26966832557291504 },
  { 0.9504860739494817, 0.3107671527496115 },
  { -0.31076715274961136, 0.9504860739494818 },
  { 0.452349587233771, 0.8918407093923427 },
  { -0.8918407093923426, 0.452349587233771 },
  { 0.759209188978388, 0.650846684996381 },
  { -0.6508466849963808, 0.7592091889783882 },
  { 0.07662386139203162, 0.997060070339483 },
  { -0.997060070339483, 0.07662386139203169 },
  { 0.9975114561403035, 0.07050457338961386 },
  { -0.0705045733896139, 0.9975114561403035 },
  { 0.6554928529996155, 0.7552013768965364 },
  { -0.7552013768965364, 0.6554928529996156 },
  { 0.8945994856313827, 0.44686884016237416 },
  { -0.446868840162374, 0.8945994856313828 },
  { 0.31659337555616585, 0.9485613499157303 },
  { -0.9485613499157303, 0.31659337555616607 },
  { 0.9645897932898128, 0.26375467897483135 },
  { -0.2637546789748314, 0.9645897932898128 },
  { 0.49556526182577254, 0.8685707059713409 },
  { -0.8685707059713409, 0.49556526182577254 },
  { 0.79023022143731, 0.6128100824294097 },
  { -0.6128100824294097, 0.79023022143731 },
  { 0.1254549834115462, 0.9920993131421918 },
  { -0.9920993131421918, 0.12545498341154626 },
  { 0.9857975091675675, 0.16793829497473117 },
  { -0.1679382949747311, 0.9857975091675675 },
  { 0.5783137964116557, 0.8158144108067338 },
  { -0.8158144108067338, 0.5783137964116557 },
  { 0.8464909387740521, 0.5324031278771979 },
  { -0.5324031278771978, 0.8464909387740521 },
  { 0.2220936209732036, 0.9750253450669941 },
  { -0.9750253450669941, 0.22209362097320365 },
  { 0.934092550404259, 0.35703096123343 },
  { -0.3570309612334299, 0.934092550404259 },
  { 0.40804416286497874, 0.9129621904283981 },
  { -0.9129621904283982, 0.4080441628649786 },
  { 0.726359155084346, 0.687315340891759 },
  { -0.6873153408917592, 0.7263591550843459 },
  { 0.02760814577896582, 0.9996188224951786 },
  { -0.9996188224951786, 0.027608145778965656 },
  { 0.9989412931868569, 0.04600318213091462 },
  { -0.04600318213091452, 0.9989412931868569 },
  { 0.6738290003787561, 0.7388873244606151 },
  { -0.7388873244606151, 0.6738290003787561 },
  { 0.9052967593181188, 0.4247796812091088 },
  { -0.42477968120910875, 0.9052967593181188 },
  { 0.33977688440682696, 0.9405060705932683 },
  { -0.9405060705932683, 0.339776884406827 },
  { 0.9707721407289504, 0.2400030224487415 },
  { -0.2400030224487414, 0.9707721407289504 },
  { 0.51673179901765, 0.8561473283751944 },
  { -0.8561473283751946, 0.5167317990176498 },
  { 0.8050313311429637, 0.5932322950397998 },
  { -0.5932322950397999, 0.8050313311429635 },
  { 0.14976453467732162, 0.9887216919603238 },
  { -0.9887216919603238, 0.14976453467732145 },
  { 0.9896220174632009, 0.14369503315029447 },
  { -0.14369503315029447, 0.9896220174632009 },
  { 0.5981607069963424, 0.8013761717231401 },
  { -0.8013761717231402, 0.5981607069963424 },
  { 0.8593018183570085, 0.5114688504379703 },
  { -0.5114688504379703, 0.8593018183570085 },
  { 0.2459550503357946, 0.9692812353565485 },
  { -0.9692812353565485, 0.24595505033579465 },
  { 0.9425731976014469, 0.3339996514420094 },
  { -0.3339996514420094, 0.9425731976014469 },
  { 0.4303264813400826, 0.9026733182372588 },
  { -0.9026733182372587, 0.4303264813400829 },
  { 0.7430079521351217, 0.669282588346636 },
  { -0.6692825883466358, 0.7430079521351218 },
  { 0.05213170468028332, 0.9986402181802653 },
  { -0.9986402181802652, 0.0521317046802836 },
  { 0.9954807554919269, 0.09496349532963899 },
  { -0.09496349532963895, 0.9954807554919269 },
  { 0.6367618612362843, 0.7710605242618137 },
  { -0.7710605242618136, 0.6367618612362844 },
  { 0.8833633386657316, 0.46868882203582796 },
  { -0.4686888220358277, 0.8833633386657317 },
  { 0.2932191626942587, 0.9560452513499964 },
  { -0.9560452513499964, 0.29321916269425896 },
  { 0.9578264130275329, 0.2873474595447295 },
  { -0.28734745954472946, 0.9578264130275329 },
  { 0.47410021465055, 0.8804708890521608 },
  { -0.8804708890521608, 0.4741002146505501 },
  { 0.7749531065948738, 0.6320187359398091 },
  { -0.632018735939809, 0.7749531065948739 },
  { 0.10106986275482786, 0.9948793307948056 },
  { -0.9948793307948056, 0.10106986275482793 },
  { 0.9813791933137546, 0.19208039704989244 },
  { -0.19208039704989227, 0.9813791933137546 },
  { 0.5581185312205562, 0.829761233794523 },
  { -0.8297612337945229, 0.5581185312205563 },
  { 0.8331701647019132, 0.5530167055800275 },
  { -0.5530167055800274, 0.8331701647019133 },
  { 0.19809841071795373, 0.9801821359681173 },
  { -0.9801821359681173, 0.19809841071795378 },
  { 0.9250492407826776, 0.37984720892405116 },
  { -0.379847208924051, 0.9250492407826777 },
  { 0.385516053843919, 0.9227011283338785 },
  { -0.9227011283338786, 0.38551605384391885 },
  { 0.7092728264388657, 0.7049340803759049 },
  { -0.7049340803759049, 0.7092728264388657 },
  { 0.003067956762966138, 0.9999952938095762 },
  { -0.9999952938095762, 0.003067956762965977 }
};

// Given a polynomial f ∈ Q[x]/(φ) with {512, 1024} coefficients, this routine
// computes fast fourier transform using Cooley-Tukey algorithm, producing
// {512, 1024} evaluations of f s.t. they are placed in bit-reversed order.
//
// Note, this routine mutates input i.e. it's an in-place FFT implementation.
//
// Implementation inspired from
// https://github.com/itzmeanjan/falcon/blob/4ab9f60/include/ntt.hpp#L59-L98
template<const size_t LOG2N>
inline void
fft(cmplx* const __restrict vec)
  requires((LOG2N > 0) && (LOG2N <= 10))
{
  constexpr size_t N = 1ul << LOG2N;

  for (int64_t l = LOG2N - 1; l >= 0; l--) {
    const size_t len = 1ul << l;
    const size_t lenx2 = len << 1;
    const size_t k_beg = N >> (l + 1);

    for (size_t start = 0; start < N; start += lenx2) {
      const size_t k_now = k_beg + (start >> (l + 1));
      // Can also be computed using computeζ<N>(bit_rev<LOG2N>(k_now))
      const auto ζ_exp = POWERS_OF_ζ[k_now];

      for (size_t i = start; i < start + len; i++) {
        const auto tmp = ζ_exp * vec[i + len];

        vec[i + len] = vec[i] - tmp;
        vec[i] = vec[i] + tmp;
      }
    }
  }
}

// Given {512, 1024} evaluations of polynomial f ∈ Q[x]/(φ) s.t. each evaluation
// ∈ C and they are placed in bit-reversed order, this routine computes inverse
// fast fourier transform using Gentleman-Sande algorithm, producing polynomial
// f s.t. its {512, 1024} coefficients are placed in standard order.
//
// Note, this routine mutates input i.e. it's an in-place iFFT implementation.
//
// Implementation inspired from
// https://github.com/itzmeanjan/falcon/blob/4ab9f60/include/ntt.hpp#L59-L98
template<const size_t LOG2N>
inline void
ifft(cmplx* const __restrict vec)
  requires((LOG2N > 0) && (LOG2N <= 10))
{
  constexpr size_t N = 1ul << LOG2N;
  constexpr double INV_N = 1. / static_cast<double>(N);

  for (size_t l = 0; l < LOG2N; l++) {
    const size_t len = 1ul << l;
    const size_t lenx2 = len << 1;
    const size_t k_beg = (N >> l) - 1;

    for (size_t start = 0; start < N; start += lenx2) {
      const size_t k_now = k_beg - (start >> (l + 1));
      // Can also be computed using -computeζ<N>(bit_rev<LOG2N>(k_now))
      const auto neg_ζ_exp = -POWERS_OF_ζ[k_now];

      for (size_t i = start; i < start + len; i++) {
        const auto tmp = vec[i];

        vec[i] = vec[i] + vec[i + len];
        vec[i + len] = tmp - vec[i + len];
        vec[i + len] = vec[i + len] * neg_ζ_exp;
      }
    }
  }

  for (size_t i = 0; i < N; i++) {
    vec[i] = vec[i] * INV_N;
  }
}

// Splits a polynomial f into two polynomials f0, f1 s.t. all the polynomials
// are in their FFT representation.
//
// This routine is an implementation of the algorithm 1, described on page 29 of
// Falcon specification https://falcon-sign.info/falcon.pdf
template<const size_t LOG2N>
inline void
split_fft(const cmplx* const __restrict f,
          cmplx* const __restrict f0,
          cmplx* const __restrict f1)
  requires((LOG2N > 0) && (LOG2N <= 10))
{
  constexpr size_t N = 1ul << LOG2N;
  constexpr size_t hN = N >> 1;

  for (size_t i = 0; i < hN; i++) {
    // Can also be computed using computeζ<N>(bit_rev<LOG2N>(hN + i))
    const auto ζ_exp = POWERS_OF_ζ[hN + i];

    f0[i] = 0.5 * (f[2 * i] + f[2 * i + 1]);
    f1[i] = 0.5 * (f[2 * i] - f[2 * i + 1]) * std::conj(ζ_exp);
  }
}

// Merges two polynomials f0, f1 into a single one f s.t. all of these
// polynomials are in their FFT representation.
//
// This routine is an implementation of the algorithm 2, described on page 29 of
// Falcon specification https://falcon-sign.info/falcon.pdf
template<const size_t LOG2N>
inline void
merge_fft(const cmplx* const __restrict f0,
          const cmplx* const __restrict f1,
          cmplx* const __restrict f)
  requires((LOG2N > 0) && (LOG2N <= 10))
{
  constexpr size_t N = 1ul << LOG2N;
  constexpr size_t hN = N >> 1;

  for (size_t i = 0; i < hN; i++) {
    // Can also be computed using computeζ<N>(bit_rev<LOG2N>(hN + i))
    const auto ζ_exp = POWERS_OF_ζ[hN + i];

    f[2 * i + 0] = f0[i] + f1[i] * ζ_exp;
    f[2 * i + 1] = f0[i] - f1[i] * ζ_exp;
  }
}

// Given a polynomial f of degree (n - 1), in its FFT representation, this
// routine computes Hermitian Adjoint f*, following section 3.3 ( see bottom of
// page 23 ) of the Falcon specification https://falcon-sign.info/falcon.pdf
template<const size_t LOG2N>
static inline void
adj_poly(cmplx* const poly)
  requires((LOG2N > 0) && (LOG2N <= 10))
{
  constexpr size_t N = 1ul << LOG2N;

  for (size_t i = 0; i < N; i++) {
    poly[i] = std::conj(poly[i]);
  }
}

}
